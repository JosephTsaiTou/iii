ch3
select * from emp;
select empno,ename,job,hiredate from emp; 
select distinct job from emp;
select empno "Emp#",ename,job "Employee",hiredate "Hire date" from emp;
select concat(ename,' , ',job)"Employee and Title" from emp;
ch4
select ename,sal from emp where sal >2850;
select ename,deptno from emp where empno=7566;
select ename,sal from emp where sal not between 1500 and 2850;
select ename,job,hiredate from emp where hiredate between 19810220 and 19810501 order by hiredate asc;
select ename,deptno from emp where deptno in (10,30) order by ename;
select ename "Employee",sal "Monthly Salary"from emp where sal >1500 and deptno in (10,30);
select ename,job,hiredate from emp where year(hiredate)=1982;
select ename,job from emp where mgr is null;
select ename,sal,ifnull(comm,0) from emp where ifnull(comm,0)>0 order by sal desc,comm desc;
select ename,job from emp where ename like '__a%' ;
select ename,mgr,deptno from emp where ename like '%LL%' and (deptno=30 or mgr=7782);
select ename,job,sal from emp where job in ('clerk','analyst') and sal not in (1000,3000,5000);
select ename,sal,ifnull(comm,0) from emp where ifnull(comm,0)>sal*1.1;
select empno,ename,job,sal,deptno from emp order by sal desc limit 5;
ch5
select curdate() "系統日期";
select empno,ename,sal,round(sal*1.15,0)"New Salary" from emp;
select empno,ename,sal,round(sal*1.15-sal,0)"Increase" from emp;
select empno,ename,date_format(hiredate,'%W, the %D of %M') from emp; 
select ename,hiredate,period_diff(extract(year_month from now()),extract(year_month from hiredate)) "Months_worked" from emp;
select concat(ename,' earns ',sal,'monthly but wants ',sal*3 ) "Dream Salaries" from emp;
select ename,lpad(sal,15,'$') "Salary" from emp;
select ename,hiredate,date_format(hiredate,'%W')"DAY" from emp order by weekday(hiredate);
(未處理0)select ename,ifnull(comm,'No comm')"COMM" from emp;
(老師版)select ename,if(comm>0,comm,'No comm') from emp;
select concat(ename,sal,repeat('*',round(sal/100,0)))"Employee_And_Their_Salaries" from emp order by (ifnull(comm,0)+sal) desc;
ch6
select max(sal)"Maximum",min(sal)"Minimum",sum(sal)"Sum",round(avg(sal))"Average" from emp;
select max(sal)"Maximum",min(sal)"Minimum",sum(sal)"Sum",round(avg(sal))"Average" from emp group by job;
select job,count(*) from emp group by job;
select count(distinct mgr)"Number of Managers" from emp where mgr is not null;
select max(sal)-min(sal) "Difference" from emp;

select empno,min(sal) 
from emp 
where mgr is not null 
group by mgr 
having min(sal)>=1000 
order by min(sal)desc; 

select year(hiredate)"YEAR",count(*) "New comming person" 
from emp 
where year(hiredate) in (1980,1981,1982,1983)
group by year(hiredate);

CH7
select e.ename,e.deptno,d.dname,d.loc 
from emp e join dept d using(deptno);

select e.ename,ifnull(e.comm,0),d.dname,loc 
from emp e join dept d using(deptno)
where ifnull(comm,0)>0;

select e.ename,d.dname 
from emp e join dept d using(deptno)
where e.ename like '%a%'; 

select e.ename,e.job,e.deptno,d.dname
from emp e join dept d using(deptno)
where d.loc='dallas';

select a.ename "Employee",a.empno "Emp#",b.ename "Manager",b.empno "Mgr#"
from emp a  join emp b on a.mgr = b.empno;

select e.ename,e.job,d.dname,e.sal,s.grade 
from emp e 	join dept d using(deptno) 
			join salgrade s on e.sal between s.losal and s.hisal;

select a.ename "Employee",a.hiredate "Emp Hiredate",b.ename "Manager",b.hiredate "Mgr Hiredate"
from emp a join emp b on a.mgr=b.empno
where a.hiredate< b.hiredate;

select d.dname "dname",d.loc "loc",count(*)"Number of People",round(avg(e.sal),2) "Salary"
from emp e 	join dept d using(deptno)
group by d.dname,d.loc;

CH8

select ename,hiredate 
from emp 
where deptno in (select deptno from emp where ename = 'blake');
			
select ename,hiredate 
from emp 
where hiredate > (select hiredate from emp where ename='blake');

select empno,ename,sal 
from emp 
where sal > (select avg(sal) from emp)
order by sal desc;

select ename,empno 
from emp
where deptno in (select deptno from emp where ename like '%t%');

select ename,deptno,job
from emp e join dept d using(deptno)
where d.loc ='dallas';

select ename,sal 
from emp
where mgr = (select empno from emp where ename ='king');

select e.deptno,e.ename,e.job
from emp e join dept d using(deptno)
where d.dname = 'sales';

select empno,ename,sal 
from emp 
where sal > (select avg(sal) from emp) and deptno in (select deptno from emp where ename like '%t%');

select ename,deptno,sal
from emp 
where (deptno,sal) in (select deptno,sal from emp where comm>0);

select ename,deptno,sal 
from emp e join dept d using(deptno)
where (sal,ifnull(comm,0)) in (select sal,ifnull(comm,0) from emp where d.loc ='dallas');

select ename,hiredate,sal 
from emp 
where (sal,ifnull(comm,0))in (select sal,ifnull(comm,0) from emp where ename='scott') and ename <> 'scott';

select ename,hiredate,sal
from emp 
where sal > (select max(sal) from emp where job='clerk');

CH9

insert into my_emp
values(5,'patel','ralph','rpatel,795');

insert into my_emp(id,last_name,first_name,userid,salary)
values(6,'dancs','betty','bdancs','860');

insert into my_emp
values (7,'biri','ben','bbiri',1100),
		(8,'newman','chad','cnewman',750);

update my_emp
set last_name = 'drexler'
where id=7;
		
update my_emp
set salary=1000
where salary<900;

delete from my_emp
where last_name ='dancs' and first_name='betty';
		
start transaction;
update my_emp
set salary*1.1;
savepoint s1;
delete from my_emp;
select * from my_emp;
rollback to s1;
commit;
		
CH10

#1
create table department2
(	id numeric(7),
	name varchar(24));

#2
insert into department2
select deptno,dname
from dept;

#3
create table employee2
(id numeric(7) not null,
last_name varchar(24),
first_name varchar(24),
dept_id numeric(7));
		
#4
alter table employee2
modify last_name varchar(40);		
		
#5		
create table employee3
as	
select empno "id",ename "last_name",deptno"dept_id" from emp;

#6
drop table employee2;

#7	
alter table employee3
rename to employee2;

#8
alter table employee2
drop column last_name;
		
#9
alter table employee2
add column salary numeric(7);

#10
alter table employee2
add constraint pk_employee2_id primary key(id); 

#11<3 steps>
alter table department2
add constraint pk_department2_id primary key(id);

alter table department2
modify id int(11);

alter table employee2
add constraint fk_employee2_id foreign key(dept_id) references department2(id);

CH11
#1
create view emp_vu
as
select empno,ename"Employee",deptno from emp;

#2
desc emp_vu;

#3
select * from emp_vu;

#4
create view dept20_2
as 
select empno "Employee_id",ename "Employee",deptno "Department_id"
from emp
where deptno =20
with check option;

#5
desc dept20_2;

#6
create view Salary_2
as
select ename "Employee",deptno"Department_id",sal "Salary",grade "Salary_Grade"
from emp e 	join dept d using (deptno)
			join salgrade s on e.sal between s.losal and s.hisal;





<practice>
